<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:EcoBank.App.ViewModels.Home"
             xmlns:domain="using:EcoBank.Core.Domain.Accounts"
             xmlns:ops="using:EcoBank.Core.Domain.Operations"
             xmlns:shad="clr-namespace:ShadUI;assembly=ShadUI"
             x:Class="EcoBank.App.Views.Home.HomeView"
             x:DataType="vm:HomeViewModel"
             Background="{DynamicResource BackgroundColor}">

  <ScrollViewer>
    <StackPanel Margin="16" Spacing="16">

      <!-- Welcome + Balance Hero - Official Green Palette -->
      <Border CornerRadius="{StaticResource RadiusCard}"
              Padding="24"
              Background="#7ED957">
        <StackPanel Spacing="8">
          <TextBlock Text="{Binding WelcomeMessage}"
                     Foreground="White"
                     FontSize="18"
                     FontWeight="SemiBold"/>
          <TextBlock Text="Solde total"
                     Foreground="White"
                     Opacity="0.85"
                     FontSize="13"/>
          <TextBlock FontSize="36"
                     FontWeight="Bold"
                     Foreground="White">
            <TextBlock.Text>
              <MultiBinding StringFormat="{}{0:N2} {1}">
                <Binding Path="TotalBalance"/>
                <Binding Path="Currency"/>
              </MultiBinding>
            </TextBlock.Text>
          </TextBlock>
        </StackPanel>
      </Border>

      <!-- Chart/Progress area -->
      <shad:Card>
        <StackPanel Spacing="12">
          <Grid ColumnDefinitions="*,Auto">
            <shad:CardTitle Grid.Column="0" Content="Ã‰volution du solde"/>
            <shad:Badge Grid.Column="1"
                        Content="+12.5%"
                        VerticalAlignment="Center"/>
          </Grid>
          <TextBlock Text="ðŸ“Š Chart placeholder"
                     Foreground="{DynamicResource MutedColor}"
                     TextAlignment="Center"
                     Padding="0,40"
                     FontSize="14"/>
        </StackPanel>
      </shad:Card>

      <!-- Quick actions -->
      <StackPanel Spacing="8">
        <TextBlock Classes="SectionTitle" Text="Actions rapides"/>
        <UniformGrid Columns="4" Rows="1" ColumnSpacing="8" RowSpacing="8">
          <StackPanel HorizontalAlignment="Center" Spacing="8">
            <Border Background="#F0F9E8"
                    CornerRadius="{StaticResource RadiusButton}"
                    Padding="16"
                    HorizontalAlignment="Center">
              <TextBlock Text="ðŸ“¤" FontSize="24"/>
            </Border>
            <TextBlock Text="Envoyer"
                       FontSize="12"
                       TextAlignment="Center"
                       FontWeight="Medium"/>
          </StackPanel>
          <StackPanel HorizontalAlignment="Center" Spacing="8">
            <Border Background="#F0F9E8"
                    CornerRadius="{StaticResource RadiusButton}"
                    Padding="16"
                    HorizontalAlignment="Center">
              <TextBlock Text="âœ“" FontSize="24" Foreground="#7ED957"/>
            </Border>
            <TextBlock Text="ReÃ§u"
                       FontSize="12"
                       TextAlignment="Center"
                       FontWeight="Medium"/>
          </StackPanel>
          <StackPanel HorizontalAlignment="Center" Spacing="8">
            <Border Background="#F0F9E8"
                    CornerRadius="{StaticResource RadiusButton}"
                    Padding="16"
                    HorizontalAlignment="Center">
              <TextBlock Text="ðŸ”„" FontSize="24"/>
            </Border>
            <TextBlock Text="Virement"
                       FontSize="12"
                       TextAlignment="Center"
                       FontWeight="Medium"/>
          </StackPanel>
          <StackPanel HorizontalAlignment="Center" Spacing="8">
            <Border Background="#F0F9E8"
                    CornerRadius="{StaticResource RadiusButton}"
                    Padding="16"
                    HorizontalAlignment="Center">
              <TextBlock Text="â€¢â€¢â€¢" FontSize="24"/>
            </Border>
            <TextBlock Text="Plus"
                       FontSize="12"
                       TextAlignment="Center"
                       FontWeight="Medium"/>
          </StackPanel>
        </UniformGrid>
      </StackPanel>

      <!-- Account Summary Cards -->
      <StackPanel Spacing="8">
        <TextBlock Classes="SectionTitle" Text="Mes comptes"/>
        <ItemsControl ItemsSource="{Binding Accounts}" Margin="0,0,0,8">
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="domain:Account">
              <shad:Card Margin="0,0,0,8">
                <Grid ColumnDefinitions="*,Auto">
                  <StackPanel Grid.Column="0" Spacing="4">
                    <shad:CardTitle Content="{Binding Label}"/>
                    <shad:CardDescription Content="{Binding Iban}"/>
                  </StackPanel>
                  <TextBlock Grid.Column="1"
                             FontSize="16"
                             FontWeight="SemiBold"
                             VerticalAlignment="Center"
                             Margin="8,0,0,0"
                             Foreground="#7ED957">
                    <TextBlock.Text>
                      <MultiBinding StringFormat="{}{0:N2} {1}">
                        <Binding Path="Balance"/>
                        <Binding Path="Currency"/>
                      </MultiBinding>
                    </TextBlock.Text>
                  </TextBlock>
                </Grid>
              </shad:Card>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </StackPanel>

      <!-- Last operations -->
      <StackPanel Spacing="8">
        <TextBlock Classes="SectionTitle" Text="DerniÃ¨res opÃ©rations"/>

        <shad:Loading IsVisible="{Binding IsBusy}"/>

        <TextBlock Text="{Binding ErrorMessage}"
                   Foreground="#FF4D4F"
                   TextWrapping="Wrap"
                   IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

        <ItemsControl ItemsSource="{Binding RecentOperations}">
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="ops:Operation">
              <shad:Card Margin="0,0,0,8">
                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                  <!-- Icon/Avatar -->
                  <shad:Avatar Grid.Column="0"
                               Fallback="ðŸ’³"
                               VerticalAlignment="Center"/>

                  <!-- Label and Date -->
                  <StackPanel Grid.Column="1" Spacing="3" VerticalAlignment="Center">
                    <shad:CardTitle Content="{Binding Label}"/>
                    <shad:CardDescription Content="{Binding Date, StringFormat={}{0:dd/MM/yyyy}}"/>
                  </StackPanel>

                  <!-- Amount -->
                  <TextBlock Grid.Column="2"
                             FontSize="14"
                             FontWeight="SemiBold"
                             VerticalAlignment="Center"
                             Margin="8,0,0,0">
                    <TextBlock.Text>
                      <MultiBinding StringFormat="{}{0:+0.00;-0.00} {1}">
                        <Binding Path="Amount"/>
                        <Binding Path="Currency"/>
                      </MultiBinding>
                    </TextBlock.Text>
                  </TextBlock>
                </Grid>
              </shad:Card>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </StackPanel>

    </StackPanel>
  </ScrollViewer>
</UserControl>
