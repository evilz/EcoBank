<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:EcoBank.App.ViewModels.Shell"
             xmlns:shad="clr-namespace:ShadUI;assembly=ShadUI"
             x:Class="EcoBank.App.Views.Shell.MainShellView"
             x:DataType="vm:MainShellViewModel">

  <!-- Responsive layout:
       - Narrow (<600px): bottom navigation bar
       - Wide (>=600px): side navigation rail
  -->
  <Panel>

    <!-- WIDE layout (sidebar) -->
    <Grid ColumnDefinitions="Auto,*"
          IsVisible="{Binding $parent[UserControl].Bounds.Width, Converter={x:Static vm:WidthToBoolConverter.IsWide}}">

      <!-- ShadUI Sidebar -->
      <shad:Sidebar Grid.Column="0">
        <shad:Sidebar.Header>
          <StackPanel Orientation="Horizontal" Spacing="10" Margin="12,0,0,24">
            <TextBlock Text="ðŸ¦" FontSize="24"/>
            <TextBlock Text="EcoBank" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
          </StackPanel>
        </shad:Sidebar.Header>

        <!-- Nav items -->
        <ItemsControl ItemsSource="{Binding Tabs}">
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="vm:NavTab">
              <shad:SidebarItem Content="{Binding Label}"
                                Command="{Binding $parent[ItemsControl].((vm:MainShellViewModel)DataContext).SelectTabCommand}"
                                CommandParameter="{Binding}">
                <shad:SidebarItem.Icon>
                  <TextBlock Text="{Binding Icon}" FontSize="18"/>
                </shad:SidebarItem.Icon>
              </shad:SidebarItem>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </shad:Sidebar>

      <!-- Content area -->
      <ContentControl Grid.Column="1"
                      Content="{Binding CurrentContent}"/>
    </Grid>

    <!-- NARROW layout (bottom nav) -->
    <Grid RowDefinitions="*,Auto"
          IsVisible="{Binding $parent[UserControl].Bounds.Width, Converter={x:Static vm:WidthToBoolConverter.IsNarrow}}">

      <!-- Content -->
      <ContentControl Grid.Row="0"
                      Content="{Binding CurrentContent}"/>

      <!-- Bottom nav -->
      <Border Grid.Row="1"
              Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
              BoxShadow="0 -2 8 0 #10000000"
              Padding="4,6">
        <ItemsControl ItemsSource="{Binding Tabs}">
          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <UniformGrid Rows="1"/>
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="vm:NavTab">
              <Button Classes="NavItem"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      Command="{Binding $parent[ItemsControl].((vm:MainShellViewModel)DataContext).SelectTabCommand}"
                      CommandParameter="{Binding}">
                <StackPanel Spacing="3" HorizontalAlignment="Center">
                  <TextBlock Text="{Binding Icon}" FontSize="22" HorizontalAlignment="Center"/>
                  <TextBlock Text="{Binding Label}" FontSize="10" HorizontalAlignment="Center"/>
                </StackPanel>
              </Button>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </Border>
    </Grid>

  </Panel>
</UserControl>
